generator client {
  provider = "prisma-client-js"
}

datasource db {
  // provider = "mysql"
  provider = env("DATABASE_PROVIDER")
  url      = env("DATABASE_URL")
}

model Users {
  id          String   @id @default(uuid())
  email       String   @unique
  password    String
  first_name  String
  last_name   String
  age         String?
  tell        String?
  image       String?
  address     String?
  role        Roles    @default(USER)
  create_date DateTime @default(now())
  update_date DateTime @updatedAt
  bookings    Bookings[]
}

enum Roles {
  ADMIN
  MANAGER
  CLIENT
  GUEST
  USER
}

model Category {
  id          String    @id @default(uuid())
  name        String    @unique
  detail      String?
  image       String?
  products    Product[] // 1 Category มีได้หลาย Products
  create_date DateTime  @default(now())
  update_date DateTime  @updatedAt
}

model Product {
  id          String    @id @default(uuid())
  name        String
  detail      String?
  image       String?
  price       String?   // ราคาเริ่มต้น หรือราคาเฉลี่ยของประเภทนี้
  rating      Int?      @default(0)
  
  // Relations
  categoryId  String
  category    Category  @relation(fields: [categoryId], references: [id])
  rooms       Rooms[]   // 1 ประเภทสินค้า (เช่น Deluxe) มีได้หลายห้องจริง
  
  create_date DateTime  @default(now())
  update_date DateTime  @updatedAt
}

model Rooms {
  id          String    @id @default(uuid())
  name        String    // เลขห้อง เช่น A101
  price       Int       // ราคาจริงของห้องนี้
  image       String?
  is_active   Boolean   @default(true)
  
  // Relations
  productId   String
  product     Product   @relation(fields: [productId], references: [id])
  
  bookingId   String?
  booking     Bookings? @relation(fields: [bookingId], references: [id])

  create_date DateTime  @default(now())
  update_date DateTime  @updatedAt
}

model Bookings {
  id            String          @id @default(uuid())
  userId        String
  user          Users           @relation(fields: [userId], references: [id])
  rooms         Rooms[]         // 1 การจองอาจจองได้หลายห้อง
  
  // สถานะและหมวดหมู่การจอง
  status        BookingStatus   @default(PENDING)
  bookingTypeId String
  bookingType   CategoryBooking @relation(fields: [bookingTypeId], references: [id])
  
  total_price   Int
  check_in      DateTime
  check_out     DateTime
  create_date   DateTime        @default(now())
  update_date   DateTime        @updatedAt
}

model CategoryBooking {
  id          String     @id @default(uuid())
  name        String     @unique // เช่น "จองรายวัน", "แพ็คเกจสัมมนา"
  detail      String?
  bookings    Bookings[]
  create_date DateTime   @default(now())
  update_date DateTime   @updatedAt
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}